"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_relay-environment_relay-environment_ts"],{69719:(e,t,r)=>{let n;r.d(t,{H:()=>x});var i=r(10204);function s(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function a(e,t,r){if(!t.has(e))throw TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}var o=new WeakMap,c=new WeakSet;let AliveSession=class AliveSession extends i.ib{constructor(e,t,r,n,i){super(e,()=>(function(e,t,r){if(!t.has(e))throw TypeError("attempted to get private field on non-instance");return r})(this,c,l).call(this),r,n,void 0,i),function(e,t){s(e,t),t.add(e)}(this,c),function(e,t,r){s(e,t),t.set(e,r)}(this,o,{writable:!0,value:void 0}),function(e,t,r){var n=a(e,t,"set");if(n.set)n.set.call(e,r);else{if(!n.writable)throw TypeError("attempted to set read only private field");n.value=r}}(this,o,t)}};function l(){var e;return u((e=a(this,o,"get"),e.get?e.get.call(this):e.value))}async function u(e){let t=await d(e);return t&&t.url&&t.token?h(t.url,t.token):null}async function d(e){let t=await fetch(e,{headers:{Accept:"application/json"}});if(t.ok)return t.json();if(404===t.status)return null;throw Error("fetch error")}async function h(e,t){let r=await fetch(e,{method:"POST",mode:"same-origin",headers:{"Scoped-CSRF-Token":t}});if(r.ok)return r.text();throw Error("fetch error")}var p=r(70170),f=r(32475),w=r(85351),b=r(23683),g=r(27851);function m(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function y(e,t,r){if(!t.has(e))throw TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function v(e,t){var r=y(e,t,"get");return r.get?r.get.call(e):r.value}function S(e,t,r){m(e,t),t.set(e,r)}function k(e,t,r){var n=y(e,t,"set");if(n.set)n.set.call(e,r);else{if(!n.writable)throw TypeError("attempted to set read only private field");n.value=r}return r}function E(e,{channel:t,type:r,data:n}){for(let i of e)i.dispatchEvent(new CustomEvent(`socket:${r}`,{bubbles:!1,cancelable:!1,detail:{name:t,data:n}}))}var _=new WeakMap,P=new WeakMap,T=new WeakMap,O=new WeakMap,M=new WeakMap,A=new WeakSet;let $=class AliveSessionProxy{subscribe(e){let t=v(this,P).add(...e);t.length&&v(this,_).port.postMessage({subscribe:t});let r=new Set(t.map(e=>e.name)),n=e.reduce((e,t)=>{let n=t.topic.name;return(0,i.JR)(n)&&!r.has(n)&&e.add(n),e},new Set);n.size&&v(this,_).port.postMessage({requestPresence:Array.from(n)})}unsubscribeAll(...e){let t=v(this,P).drain(...e);t.length&&v(this,_).port.postMessage({unsubscribe:t});let r=v(this,T).removeSubscribers(e);this.sendPresenceMetadataUpdate(r)}updatePresenceMetadata(e){let t=new Set;for(let r of e)v(this,T).setMetadata(r),t.add(r.channelName);this.sendPresenceMetadataUpdate(t)}sendPresenceMetadataUpdate(e){if(!e.size)return;let t=[];for(let r of e)t.push({channelName:r,metadata:v(this,T).getChannelMetadata(r)});v(this,_).port.postMessage({updatePresenceMetadata:t})}online(){v(this,_).port.postMessage({online:!0})}offline(){v(this,_).port.postMessage({online:!1})}hangup(){v(this,_).port.postMessage({hangup:!0})}constructor(e,t,r,n,s,a){!function(e,t){m(e,t),t.add(e)}(this,A),S(this,_,{writable:!0,value:void 0}),S(this,P,{writable:!0,value:new i.m0}),S(this,T,{writable:!0,value:new i.VH}),S(this,O,{writable:!0,value:void 0}),S(this,M,{writable:!0,value:new Map}),k(this,O,s),k(this,_,new SharedWorker(`${e}?module=true`,{name:`github-socket-worker-v3-${n}`,type:"module"})),v(this,_).port.onmessage=({data:e})=>(function(e,t,r){if(!t.has(e))throw TypeError("attempted to get private field on non-instance");return r})(this,A,N).call(this,e),v(this,_).port.postMessage({connect:{url:t,refreshUrl:r,options:a}})}};function N(e){let{channel:t}=e;if("presence"===e.type){let r=v(this,M).get(t);r||(r=(0,p.s)((e,r)=>{v(this,O).call(this,e,r),v(this,M).delete(t)},100),v(this,M).set(t,r)),r(v(this,P).subscribers(t),e);return}v(this,O).call(this,v(this,P).subscribers(t),e)}async function R(){let e=function(){let e=document.head.querySelector("link[rel=shared-web-socket-src]")?.getAttribute("href");return e&&e.startsWith("/")?e:null}();if(!e)return;let t=document.head.querySelector("link[rel=shared-web-socket]")?.href??null;if(!t)return;let r=document.head.querySelector("link[rel=shared-web-socket]")?.getAttribute("data-refresh-url")??null;if(!r)return;let n=document.head.querySelector("link[rel=shared-web-socket]")?.getAttribute("data-session-id")??null;if(!n)return;let i=(()=>{let i=(0,g.G7)("alive_legacy_retries")?{socketPolicy:{timeout:4e3,attempts:7}}:{};if(!(0,b.nr)()&&"SharedWorker"in window&&"true"!==(0,w.A)("localStorage").getItem("bypassSharedWorker"))try{return new $(e,t,r,n,E,i)}catch{}return new AliveSession(t,r,!1,E,i)})();return window.addEventListener("online",()=>i.online()),window.addEventListener("offline",()=>i.offline()),window.addEventListener("pagehide",()=>{"hangup"in i&&i.hangup()}),i}async function C(){return await f.G,R()}function x(){return n||(n=C())}},35932:(e,t,r)=>{r.d(t,{$:()=>a});var n=r(10204),i=r(76899);let s=new WeakMap;function a(e,t,r){let a;if(!e)throw Error("Not connected to alive");if(!t)throw Error("No channel name");let o=n.KK.parse(t);if(!o)throw Error("Invalid channel name");let c={subscriber:{dispatchEvent:e=>{e instanceof CustomEvent&&r(e.detail.data)}},topic:o},l=((a=s.get(e))||(a={subscribe:(0,i.rK)(t=>e.subscribe(t.flat())),unsubscribeAll:(0,i.rK)(t=>e.unsubscribeAll(...t))},s.set(e,a)),a);return l.subscribe([c]),{unsubscribe:()=>l.unsubscribeAll(c.subscriber)}}},53005:(e,t,r)=>{r.d(t,{O:()=>a,S:()=>s});var n=r(96679);let i=n.cg?.document?.head?.querySelector('meta[name="release"]')?.content||"",s="X-GitHub-Client-Version";function a(){return i}},76899:(e,t,r)=>{function n(){return Promise.resolve()}function i(){return new Promise(window.requestAnimationFrame)}async function s(e,t){let r,n=new Promise(t=>{r=self.setTimeout(t,e)});if(!t)return n;try{await Promise.race([n,function(e){return new Promise((t,r)=>{let n=Error("aborted");n.name="AbortError",e.aborted?r(n):e.addEventListener("abort",()=>r(n))})}(t)])}catch(e){throw self.clearTimeout(r),e}}r.d(t,{G$:()=>i,k2:()=>n,rK:()=>a,uk:()=>s});function a(e){let t=[];return function(r){t.push(r),1===t.length&&queueMicrotask(()=>{let r=t.slice(0);t.length=0,e(r)})}}},26559:(e,t,r)=>{r.d(t,{jC:()=>c,kt:()=>a,tV:()=>o});var n=r(53005),i=r(27851),s=r(88191);function a(e){let t={"X-Requested-With":"XMLHttpRequest",...(0,s.wE)(e)};return(0,i.G7)("client_version_header")&&(t={...t,[n.S]:(0,n.O)()}),t}function o(e,t){for(let[r,n]of Object.entries(a(t)))e.set(r,n)}function c(e){return{"X-GitHub-App-Type":e}}},88191:(e,t,r)=>{r.d(t,{$r:()=>a,M1:()=>o,li:()=>i,pS:()=>l,wE:()=>c});var n=r(96679);let i="X-Fetch-Nonce",s=new Set;function a(e){s.add(e)}function o(){return s.values().next().value||""}function c(e){let t={};return void 0!==e&&(t["X-Fetch-Nonce-To-Validate"]=e),void 0===e?t[i]=o():s.has(e)?t[i]=e:t[i]=Array.from(s).join(","),t}function l(){let e=n.XC?.head?.querySelector('meta[name="fetch-nonce"]')?.content||"";e&&a(e)}},3785:(e,t,r)=>{r.d(t,{Av:()=>o,BM:()=>i,Gr:()=>c,HX:()=>d,M_:()=>h,RD:()=>u,rb:()=>s});var n=r(96679);let i="GraphQLTraces",s="GraphQLTracingRefresh",a=decodeURIComponent(new URLSearchParams(n.fV.search).get("disable_clusters")||"").split(",").filter(e=>""!==e);function o(e){if(!n.cg||!c()||!e)return;let t=n.cg;t&&!t[i]&&(t[i]=[]),t&&e.__trace&&(t[i].push(e.__trace),"function"==typeof t[s]&&t[s]())}function c(){let e=n.cg;return"true"===new URLSearchParams(n.fV.search).get("_tracing")||e&&void 0!==e[i]}function l(){return a.length>0}function u(e){if(!c()&&!l())return e;let t=new URL(e,n.fV.origin);return c()&&t.searchParams.set("_tracing","true"),l()&&t.searchParams.set("disable_clusters",a.join(",")),t.pathname+t.search}function d(e){return a.indexOf(e)>-1}function h(e){let t=a.indexOf(e);t>-1?a.splice(t,1):a.push(e);let r=new URLSearchParams(n.fV.search);r.set("disable_clusters",a.join(",")),n.fV.search=r.toString()}},96615:(e,t,r)=>{r.d(t,{VB:()=>SSRNetwork,SD:()=>A,E7:()=>M});var n=r(40961),i=r(69487),s=r(3785),a=r(60039),o=r(96679),c=r(22353);let l=["SAML","SERVICE_UNAVAILABLE"],u={FORBIDDEN:["SAML error"],AUTHENTICATION:["Couldn\u2019t authenticate you"]},d={NOT_FOUND:[["repository","discussion"],["repository","issue","*","edges","*","node","commit","signature","signer"],["node","*","edges","*","node","commit","signature","signer"]]};var h=r(27851),p=r(26559);function f(e,t){let r=d[e];if(!r)return!1;for(let e of r){if(t.length!==e.length)continue;let r=!0;for(let n=0;n<t.length;n++)if(t[n]!==e[n]&&"*"!==e[n]){r=!1;break}if(r)return!0}return!1}let w=class ValidationError extends Error{constructor(e,t,r){super(e,t),function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"catalogService",void 0),this.catalogService=r,this.name="ValidationError"}};async function b(e,t,r){if(e.status>401&&404!==e.status){let n=await e.text(),i={url:e.url,timestamp:new Date().toISOString(),persistedQueryId:t,persistedQueryName:r,failureRequestId:e.headers.get("X-Github-Request-Id")};throw Error(`HTTP error (${e.status}): ${n||"No additional text"}.
    Error Info: ${JSON.stringify(i)}`,{cause:e.status})}}async function g(e,t,r,n="GET",i,s,a,o){return(await m(e,t,r,n,{isSubscription:!1,scope:void 0},i,s,a,o)).response}async function m(e,t,r,n="POST",a={},d,p,b,g){let v=JSON.stringify((0,i.stableCopy)({query:e,variables:r,...a.scopeObject?{scopeObject:a.scopeObject}:{}})),{isSubscription:S,scope:k,subscriptionTopic:E,dispatchTime:_}=a,P=(0,h.G7)("nonreporting_relay_graphql_status_codes"),T=function(e,t,r,n,i,s,a="/_graphql"){let c=[];if("GET"===e&&c.push(`body=${t}`),r&&c.push("subscription=1"),i&&c.push(`scope=${encodeURIComponent(i)}`),n&&c.push(`subscriptionTopic=${encodeURIComponent(n)}`),s&&c.push(`dispatchTime=${encodeURIComponent(s)}`),o.cg){let e=new URL(o.cg.location.href,o.cg.location.origin).searchParams.get("_features");e&&c.push(`_features=${e}`)}return c.length>0?`${a}?${c.join("&")}`:a}(n,encodeURIComponent(v),S,E,k,_,d),O=null;try{let{subscriptionId:r,requestId:i,json:a,status:o}=await y(T,n,e,t,v,p);if(O=r,b&&a.errors){let e=b[o];if(e)for(let r of a.errors){let n=e[r.type];n?.({persistedQueryName:t,errorMessage:r.message})}}let d=function(e,t,r,n){var i,s;if(i=t,s=e,"errors"in s&&(s.errors.filter(e=>l.includes(e.type)||!!u[e.type]?.includes(e.message)||f(e.type,e.path)).map(e=>{console.error(`Failed to fetch data. Please use this request ID when contacting support: ${i} Error: ${e.type}: ${e.message} (path: ${e.path})`)}),s.errors=s.errors.filter(e=>!l.includes(e.type)&&!u[e.type]?.includes(e.message)&&!f(e.type,e.path))),"errors"in e&&e.errors.length){let t=e.errors.map(e=>`GraphQL error: ${e.type}: ${e.message} (path: ${e.path})`).join(", "),i=new w(`${t} (Persisted query id: ${r})`,{cause:e.errors},e.extensions?.query_owning_catalog_service);if(n)(0,c.N7)(i),n.error(i);else throw i}if(!("data"in e)){let i=Error(`Expected data property in response: ${JSON.stringify(e)}. persistedQueryId: ${r}, requestId: ${t}`);if(n)(0,c.N7)(i),n.error(i);else throw i}return e}(a,i,e,g);return d&&(0,s.Av)(d),{subscriptionId:O,response:d}}catch(e){if(g)return P&&429===e.cause||(0,c.N7)(e),g.error(e),{subscriptionId:O,response:{errors:[{message:"An error occurred while fetching data. Please try again later."}],extensions:{}}};throw e}}async function y(e,t,r,n,i,a){return v((0,s.RD)(e),t,r,n,i,a)}async function v(e,t,r,n,i,s){let o,l,u=(0,h.G7)("issues_catch_non_json_graphql_response"),d={...(0,p.kt)()};s?.issues_react_perf_test&&(d["X-LUC-Environment"]="issues");let f=(o="GET"===t?u?await fetch(e,{method:t,cache:"no-cache",credentials:"include",headers:{Accept:"application/json",...d}}):await fetch(e,{method:t,cache:"no-cache",credentials:"include",headers:d}):await (0,a.DI)(e,{method:t,headers:{Accept:"application/json",...d},...i?{body:i}:void 0})).headers.get("X-Subscription-ID"),w=o.headers.get("X-Github-Request-Id")||"",g=o.status;if(await b(o,r,n),u)try{l=await o.json()}catch(r){let t={error:r,status:g,url:e,requestId:w};throw(0,c.N7)(Error(`Failed to parse server JSON response ${JSON.stringify(t)}`)),Error(`Failed to parse server response. Please try again later. ${JSON.stringify(t)}`)}else l=await o.json();return{subscriptionId:f,requestId:w,json:l,status:g}}let S=[{kind:"linked",handle(e,t,r){if(null!=t&&t.getType()===i.ROOT_TYPE&&"node"===e.name&&r.hasOwnProperty("id"))return r.id}},{kind:"pluralLinked",handle(e,t,r){if(null!=t&&t.getType()===i.ROOT_TYPE&&"nodes"===e.name&&r.hasOwnProperty("ids"))return r.ids}}];var k=r(69719),E=r(35932),_=r(69982);function P(e){return(0,_.unstable_scheduleCallback)(_.unstable_LowPriority,e)}function T(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let O={cancel:()=>!1,schedule:e=>((0,n.unstable_batchedUpdates)(e),"")};let SSRNetwork=class SSRNetwork{execute(e,t,r){return this.relayNetwork.execute(e,t,r)}getPreloadedSubscriptions(){return this.preloadedSubscriptions}constructor(e,t={},r,n,s,a){T(this,"relayNetwork",void 0),T(this,"ssrPreloadedData",void 0),T(this,"preloadedSubscriptions",void 0),T(this,"warningsShown",void 0),T(this,"enabled_features",void 0),T(this,"maxAge",void 0),T(this,"errorCallbacks",void 0),this.ssrPreloadedData=e,this.enabled_features=t,this.preloadedSubscriptions=r,this.warningsShown=new Set,this.maxAge=s,this.errorCallbacks=a,this.relayNetwork=i.Network.create((e,t)=>i.Observable.create(r=>{let i=function({params:e,variables:t,ssrPreloadedQueries:r,baseUrl:n,emitWarning:i,enabledFeatures:s,maxAge:a,errorCallbacks:c,observer:l}){if(!e.id)throw Error("params has no id property!");if(e.id&&r){let n=JSON.stringify(t),i=r.get(e.id)?.get(n),s=Math.floor(Date.now()/1e3),c=i?.timestamp;if(i&&(l.next(i),!(a&&c&&s>c+a)))return void l.complete();e.metadata?.isRelayRouteRequest&&(0,o.g5)()}let u="mutation"===e.operationKind?"POST":"GET";if(o.KJ)return g(e.id,e.name,t,u,n,s,c,l)}({params:e,variables:t,ssrPreloadedQueries:this.ssrPreloadedData,baseUrl:n,emitWarning:e=>{this.warningsShown.has(e)||(this.warningsShown.add(e),console.warn(e))},enabledFeatures:this.enabled_features,maxAge:s,errorCallbacks:this.errorCallbacks,observer:r});i instanceof Promise&&i.then(e=>{if(!Array.isArray(e)&&"extensions"in e&&e.extensions&&e.extensions.subscriptions){let t=e.extensions.subscriptions;for(let e in t)for(let r in this.preloadedSubscriptions.has(e)||this.preloadedSubscriptions.set(e,new Map),t[e])this.preloadedSubscriptions.get(e)?.set(r,t[e][r])}r.next(e),r.complete()})}),(e,t)=>(function(e,t,r=new Map){let n=e.id,s=e.name;return i.Observable.create(i=>{let a=()=>{},o=!1;return async function(){if(!n)throw Error("unexpected operation with no id!");let l=e.metadata?.scope,u=function(e,t,r,n){let i=n.get(e);if(i)e:for(let[e,n]of i){for(let[n,i]of Object.entries(JSON.parse(e)))if("$scope"===n&&r!==i||t[n]!==i)continue e;return n}}(n,t,l,r),d=null;if(u)d=u.subscriptionId,u.response&&i.next(u.response);else try{let e=await m(n,s,t,"GET",{isSubscription:!0,scope:l});d=e.subscriptionId,e.response&&i.next(e.response)}catch(e){if(e instanceof Error&&e.message.includes("Subscription halted"))return;throw e}try{let e=await (0,k.H)();if(o)return;let r=(0,E.$)(e,d,async({scope_object:e,subscription_topic:r,dispatch_time:a})=>{try{let{response:o}=await m(n,s,{...t},"GET",{isSubscription:!0,scopeObject:e,subscriptionTopic:r,dispatchTime:a,scope:l});o&&i.next(o)}catch(e){(0,c.N7)(e,{message:`Error in fetching update for ${n} with variables ${JSON.stringify(t)}`})}});r?.unsubscribe&&(a=r.unsubscribe)}catch(e){i.error(e)}}(),{get closed(){return o},unsubscribe(){o=!0,a()}}})})(e,t,this.preloadedSubscriptions))}};let M=(e,t)=>{let r=new SSRNetwork(new Map,{},new Map,e,void 0,t),n=new i.Environment({scheduler:O,store:new i.Store(new i.RecordSource,{gcReleaseBufferSize:50,queryCacheExpirationTime:3e5,gcScheduler:P}),getDataID:(e,t)=>{if("Viewer"===t)return null==e.id?(0,i.generateClientID)("client:root","viewer"):e.id;if("ProjectV2SingleSelectFieldOption"===t){let t=[];return e.id&&t.push(e.id),e.name&&t.push(e.name),e.color&&t.push(e.color),e.description&&t.push(function(e){let t=0;if(0===e.length)return t;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r)|0;return t}(e.description)),t.join("_")}return e.id},network:r,missingFieldHandlers:S});return n.options={baseUrl:e,getPreloadedSubscriptions:()=>r.getPreloadedSubscriptions()},n};function A({environment:e,query:t,variables:r={}}){let n=(0,i.getRequest)(t),s=(0,i.createOperationDescriptor)(n,r);return e.retain(s),(0,i.fetchQuery)(e,t,r,{fetchPolicy:"store-or-network"})}}}]);
//# sourceMappingURL=ui_packages_relay-environment_relay-environment_ts-826b6a937fcd.js.map